<!--KeepCool-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

    <title>Loading Screen By KeepCool</title>
    <style type="text/css">
        body {
            color: #ffffff;
            background: #000000;
        }
    </style>


    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>


</head>

<body>
    <header>
        <!--KeepCool-->


        <canvas width="350" height="350" style="display:none;"></canvas>
        <img id="logo" class="logo" src="https://media.discordapp.net/attachments/880306428617834537/899021636198604861/image0.png?width=1202&height=676" width="750" height="450" />

        <!-- <img class="logo" src="img/logo.png" width="150"height="150" /> -->

        <script src="js/jquery-1.11.0.min.js"></script>
        <script src="js/jquery.backstretch.min.js"></script>
        <script src="js/owl.carousel.min.js"></script>
        <script src="js/jquery.ajaxchimp.js"></script>
        <script src="js/lj-safety-first.js"></script>
        <script src="js/keepcoolmusic.js"></script>

        <html>

        <head>
            <link href="css/style.css" rel="stylesheet" type="text/css" />
        </head>

        <body>
            <div id="background">

            </div>
            <div id="particles-js"></div>
            <div id="debug" class="log log-top-right"></div>

            <div class="loading-container">
                <div class="loading-labels">
                    <div id="INIT_BEFORE_MAP_LOADED-label" class="color-first">Pré-chargement</div>
                    <div id="MAP-label" class="color-first">Map</div>
                    <div id="INIT_AFTER_MAP_LOADED-label" class="color-first">Initialisation</div>
                    <div id="INIT_SESSION-label" class="color-first">Session</div>
                </div>
                <div class="loading-bar-container">
                    <div id="INIT_BEFORE_MAP_LOADED-bar" class="loading-bar bgcolor-first"></div>
                    <div id="MAP-bar" class="loading-bar bgcolor-first"></div>
                    <div id="INIT_AFTER_MAP_LOADED-bar" class="loading-bar bgcolor-first"></div>
                    <div id="INIT_SESSION-bar" class="loading-bar bgcolor-first"></div>
                </div>
            </div>
            </div>
            </div>

            <!--KeepCool-->

            <script>
                particlesJS("particles-js", {
                    "particles": {
                        "number": {
                            "value": 750,
                            "density": {
                                "enable": true,
                                "value_area": 500
                            }
                        },
                        "color": {
                            "value": "#dbbc2e"
                        },
                        "shape": {
                            "type": "circle",
                            "stroke": {
                                "width": 0,
                                "color": "#000000"
                            },
                            "polygon": {
                                "nb_sides": 4
                            },
                            "image": {
                                "src": "img/github.svg",
                                "width": 100,
                                "height": 100
                            }
                        },
                        "opacity": {
                            "value": 0.5,
                            "random": true,
                            "anim": {
                                "enable": false,
                                "speed": 0.5,
                                "opacity_min": 0.1,
                                "sync": false
                            }
                        },
                        "size": {
                            "value": 1.5,
                            "random": true,
                            "anim": {
                                "enable": true,
                                "speed": 2,
                                "size_min": 0,
                                "sync": false
                            }
                        },
                        "line_linked": {
                            "enable": false,
                            "distance": 500,
                            "color": "#ffffff",
                            "opacity": 0.4,
                            "width": 2
                        },
                        "move": {
                            "enable": true,
                            "speed": 2.8914764163227265,
                            "direction": "top",
                            "random": true,
                            "straight": false,
                            "out_mode": "out",
                            "bounce": false,
                            "attract": {
                                "enable": false,
                                "rotateX": 600,
                                "rotateY": 1200
                            }
                        }
                    },
                    "interactivity": {
                        "detect_on": "canvas",
                        "events": {
                            "onhover": {
                                "enable": false,
                                "mode": "bubble"
                            },
                            "onclick": {
                                "enable": false,
                                "mode": "repulse"
                            },
                            "resize": true
                        },
                        "modes": {
                            "grab": {
                                "distance": 400,
                                "line_linked": {
                                    "opacity": 0.5
                                }
                            },
                            "bubble": {
                                "distance": 400,
                                "size": 4,
                                "duration": 0.3,
                                "opacity": 1,
                                "speed": 3
                            },
                            "repulse": {
                                "distance": 200,
                                "duration": 0.4
                            },
                            "push": {
                                "particles_nb": 4
                            },
                            "remove": {
                                "particles_nb": 2
                            }
                        }
                    },
                    "retina_detect": true
                });
                var count_particles, stats, update;
            </script>

            <script type="text/javascript">
                if (!String.format) {
                    String.format = function(format) {
                        var args = Array.prototype.slice.call(arguments, 1);
                        return format.replace(/{(\d+)}/g, function(match, number) {
                            return typeof args[number] != 'undefined' ?
                                args[number] :
                                match;
                        });
                    };
                }

                function add(a, b) {
                    return a + b;
                }

                const loadingStages = ["Pré-chargement", "Map", "Initialisation", "Session"];
                const technicalNames = ["INIT_BEFORE_MAP_LOADED", "MAP", "INIT_AFTER_MAP_LOADED", "INIT_SESSION"];
                var currentLoadingStage = 0;
                var loadingWeights = [1.3 / 10, 4.2 / 10, 1.5 / 10, 3 / 10];

                var loadingTotals = [70, 70, 70, 220];
                var registeredTotals = [0, 0, 0, 0];
                var stageVisible = [false, false, false, false];

                var currentProgress = [0.0, 0.0, 0.0, 0.0];
                var currentProgressSum = 0.0;
                var currentLoadingCount = 0;

                var minScale = 1.00
                var maxScale = 1.0
                var diffScale = maxScale - minScale
                var backgroundPositionEnd = [0, 0];

                function doProgress(stage) {
                    var idx = technicalNames.indexOf(stage);
                    if (idx >= 0) {
                        registeredTotals[idx]++;
                        if (idx > currentLoadingStage) {
                            while (currentLoadingStage < idx) {
                                currentProgress[currentLoadingStage] = 1.0;
                                currentLoadingStage++;
                            }
                            currentLoadingCount = 1;
                        } else
                            currentLoadingCount++;
                        currentProgress[currentLoadingStage] = Math.min(currentLoadingCount / loadingTotals[idx], 1.0);
                        updateProgress();
                    }
                }

                const totalWidth = 99.1;
                var progressPositions = [];
                var progressMaxLengths = [];
                progressPositions[0] = 0.0;

                var i = 0;
                while (i < currentProgress.length) {
                    progressMaxLengths[i] = loadingWeights[i] * totalWidth;
                    progressPositions[i + 1] = progressPositions[i] + progressMaxLengths[i];
                    i++;
                }

                function updateBackground() {
                    var i = 0;
                    currentProgressWeightedSum = 0;
                    while (i < currentProgress.length) {
                        currentProgressWeightedSum += currentProgress[i] * loadingWeights[i];
                        i++;
                    }
                    document.querySelector('#background').style.transform = String.format('scale({0})', minScale + diffScale * currentProgressWeightedSum);
                    document.querySelector('#background').style.backgroundPosition = String.format('{0}px {1}px', backgroundPositionEnd[0] * currentProgressWeightedSum, backgroundPositionEnd[1] * currentProgressWeightedSum);
                }


                function updateProgress() {
                    document.querySelector('#debug').innerHTML = '';
                    var i = 0;
                    while (i <= currentLoadingStage) {
                        if ((currentProgress[i] > 0 || !currentProgress[i - 1]) && !stageVisible[i]) {
                            document.querySelector("#" + technicalNames[i] + "-label").style.display = 'inline-block';

                            document.querySelector("#" + technicalNames[i] + "-bar").style.display = 'inline-block';
                            stageVisible[i] = true;
                        }
                        document.querySelector("#" + technicalNames[i] + "-bar").style.width = currentProgress[i] * progressMaxLengths[i] + '%';
                        document.querySelector("#" + technicalNames[i] + "-label").style.width = progressMaxLengths[i] + '%';
                        document.querySelector('#debug').innerHTML += String.format('{0}: {1}<br />', technicalNames[i], currentProgress[i]);
                        i++;
                    }
                    updateBackground();
                }

                updateProgress();




                var count = 0;
                var thisCount = 0;

                const gstate = {
                    elems: [],
                    log: []
                };

                const emoji = {
                    INIT_BEFORE_MAP_LOADED: ['🍉'],
                    INIT_AFTER_MAP_LOADED: ['🍋', '🍊'],
                    INIT_SESSION: ['🍐', '🍅', '🍆'],
                };

                function printLog(type, str) {
                    gstate.log.push({
                        type: type,
                        str: str
                    });
                };

                Array.prototype.last = function() {
                    return this[this.length - 1];
                };

                const handlers = {
                    startInitFunction(data) {
                        gstate.elems.push({
                            name: data.type,
                            orders: []
                        });

                        printLog(1, String.format('Running {0} init functions', data.type));
                        if (data.type) doProgress(data.type);
                    },

                    startInitFunction2(data) {
                        gstate.elems.push({
                            name: data.type,
                            orders: []
                        });

                        printLog(4, String.format('Chargement de {0}...', data.type));
                        if (data.type) doProgress(data.type);
                    },

                    startInitFunction3(data) {
                        gstate.elems.push({
                            name: data.type,
                            orders: []
                        });

                        printLog(5, String.format('{0}', data.type));
                        if (data.type) doProgress(data.type);
                    },

                    startInitFunctionOrder(data) {
                        count = data.count;
                        printLog(1, String.format('[{0}] Running functions of order {1} ({2} total)', data.type, data.order, data.count));
                        if (data.type) doProgress(data.type);
                    },

                    initFunctionInvoking(data) {
                        printLog(3, String.format('Invoking {0} {1} init ({2} of {3})', data.name, data.type, data.idx, count));
                        if (data.type) doProgress(data.type);
                    },

                    initFunctionInvoked(data) {
                        if (data.type) doProgress(data.type);
                    },

                    endInitFunction(data) {
                        printLog(1, String.format('Done running {0} init functions', data.type));
                        if (data.type) doProgress(data.type);
                    },

                    startDataFileEntries(data) {
                        count = data.count;

                        printLog(1, 'Chargement de la map');
                        if (data.type) doProgress(data.type);
                    },

                    onDataFileEntry(data) {
                        printLog(3, String.format('Chargement de {0}', data.name));
                        doProgress(data.type);
                        if (data.type) doProgress(data.type);
                    },

                    endDataFileEntries() {
                        printLog(1, 'Chargement de la map terminé');
                    },

                    performMapLoadFunction(data) {
                        doProgress('MAP');
                    },

                    onLogLine(data) {
                        printLog(3, data.message);
                    }
                };

                /*setInterval(function() {
                    document.querySelector('#log').innerHTML = gstate.log.slice(-10).map(function(e) {
                        return String.format("[{0}] {1}", e.type, e.str)
                    }).join('<br />');
                }, 100);*/

                window.addEventListener('message', function(e) {
                    (handlers[e.data.eventName] || function() {})(e.data);
                });



                if (!window.invokeNative) {

                    var newType = function newType(name) {
                        return function() {
                            return handlers.startInitFunction({
                                type: name
                            });
                        };
                    };
                    var newType2 = function newType(name) {
                        return function() {
                            return handlers.startInitFunction2({
                                type: name
                            });
                        };
                    };
                    var newType3 = function newType(name) {
                        return function() {
                            return handlers.startInitFunction3({
                                type: name
                            });
                        };
                    };
                    var newOrder = function newOrder(name, idx, count) {
                        return function() {
                            return handlers.startInitFunctionOrder({
                                type: name,
                                order: idx,
                                count: count
                            });
                        };
                    };
                    var newInvoke = function newInvoke(name, func, i) {
                        return function() {
                            handlers.initFunctionInvoking({
                                type: name,
                                name: func,
                                idx: i
                            });
                            handlers.initFunctionInvoked({
                                type: name
                            });
                        };
                    };
                    var startEntries = function startEntries(count) {
                        return function() {
                            return handlers.startDataFileEntries({
                                count: count
                            });
                        };
                    };
                    var addEntry = function addEntry() {
                        return function() {
                            return handlers.onDataFileEntry({
                                name: 'meow',
                                isNew: true
                            });
                        };
                    };
                    var stopEntries = function stopEntries() {
                        return function() {
                            return handlers.endDataFileEntries({});
                        };
                    };

                    var newTypeWithOrder = function newTypeWithOrder(name, count) {
                        return function() {
                            newType(name)();
                            newOrder(name, 1, count)();
                        };
                    };

                    const demoFuncs = [
                        newTypeWithOrder('MAP', 5),
                        newInvoke('MAP', 'meow1', 1),
                        newInvoke('MAP', 'meow2', 2),
                        newInvoke('MAP', 'meow3', 3),
                        newInvoke('MAP', 'meow4', 4),
                        newInvoke('MAP', 'meow5', 5),
                        newOrder('MAP', 2, 2),
                        newInvoke('MAP', 'meow1', 1),
                        newInvoke('MAP', 'meow2', 2),
                        newTypeWithOrder('INIT_SESSION', 4),
                        newInvoke('INIT_SESSION', 'meow1', 1),
                        newInvoke('INIT_SESSION', 'meow2', 2),
                        newInvoke('INIT_SESSION', 'meow3', 3),
                        newInvoke('INIT_SESSION', 'meow4', 4),

                        newType2('adhesive.dll'),

                        newType2('gta-streaming-five.dll'),
                    ];

                    setInterval(function() {
                        demoFuncs.length && demoFuncs.shift()();
                    }, 350);
                }
            </script>

            <h1 class="enable_music">Appuyez sur <strong>ESPACE</strong> pour mettre en pause la musique</h1>



        </body>

        </html>

        <!--KeepCool-->